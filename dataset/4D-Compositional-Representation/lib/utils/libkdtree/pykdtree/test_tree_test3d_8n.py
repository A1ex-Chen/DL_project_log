def test3d_8n():
    query_pts = np.array([[787014.438, -340616.906, 6313018.0], [751763.125,
        -59925.969, 6326205.5], [769957.188, -202418.125, 6321069.5]])
    kdtree = KDTree(data_pts_real)
    dist, idx = kdtree.query(query_pts, k=8)
    exp_dist = np.array([[0.0, 4052.50235, 4073.89794, 8082.01128, 
        8170.63009, 12090.4577, 12290.2057, 16077.5136], [1.73205081, 
        2702.16896, 2714.31274, 5395.37066, 5437.9321, 8078.55631, 
        8171.1997, 10751.3693], [141.424892, 3255.00021, 3442.84958, 
        6580.19346, 6810.38455, 9891.40135, 10191.8659, 13189.2516]])
    exp_idx = np.array([[7, 8, 6, 9, 5, 10, 4, 11], [93, 94, 92, 95, 91, 96,
        90, 97], [45, 46, 44, 47, 43, 48, 42, 49]])
    assert np.array_equal(idx, exp_idx)
    assert np.allclose(dist, exp_dist)
